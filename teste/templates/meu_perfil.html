{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container mt-4">
  <form method="POST" enctype="multipart/form-data">
    {% csrf_token %}

    <div class="row mb-4">
      <div class="col-md-3 text-center">
        {% if perfil.foto %}
          <img src="{{ perfil.foto.url }}" class="rounded-circle img-thumbnail mb-2" width="140" height="140" style="object-fit: cover;">
        {% else %}
          <img src="{% static 'img/avatar_padrao.png' %}" class="rounded-circle img-thumbnail mb-2" width="140" height="140" style="object-fit: cover;">
        {% endif %}

        <div>
          <input type="file" name="foto" id="foto" class="form-control mb-2">
          <small class="text-muted">We only support PNG or JPG pictures.</small>
        </div>
      </div>

      <div class="col-md-9">
        <h3 class="mb-3">{{ request.user.username }}</h3>
        <h4>Basic Information</h4>
        <div class="row">
          <div class="col-md-6 mb-3">
            <label for="posicao" class="form-label">Posição</label>
            <select name="posicao" id="posicao" class="form-control">
              <option value="">Selecione</option>
              {% for chave, nome in perfil.POSICOES %}
                <option value="{{ chave }}" {% if perfil.posicao == chave %}selected{% endif %}>{{ nome }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="col-md-2 mb-3">
            <label for="idade" class="form-label">Idade</label>
            <input type="number" name="idade" value="{{ perfil.idade }}" class="form-control form-control-sm">
          </div>
          <div class="col-md-2 mb-3">
            <label for="peso" class="form-label">Peso (kg)</label>
            <input type="number" name="peso" step="0.01" value="{{ perfil.peso }}" class="form-control form-control-sm">
          </div>
          <div class="col-md-2 mb-3">
            <label for="altura" class="form-label">Altura (m)</label>
            <input type="number" name="altura" step="0.01" value="{{ perfil.altura }}" class="form-control form-control-sm">
          </div>
        </div>

        <button type="submit" class="btn btn-primary">Salvar Informações</button>
      </div>
    </div>
  </form>

  <hr>

  <div class="card mb-4">
    <div class="card-body">
      <h4 class="card-title">Estatísticas Totais</h4>
      <ul class="mb-0">
        <li><strong>Gols:</strong> {{ total_gols }}</li>
        <li><strong>Assistências:</strong> {{ total_assistencias }}</li>
        <li><strong>Cartões Amarelos:</strong> {{ cartoes_amarelos }}</li>
        <li><strong>Cartões Vermelhos:</strong> {{ cartoes_vermelhos }}</li>
      </ul>
    </div>
  </div>

  <div class="card mb-4">
    <div class="card-body">
      <h4 class="card-title">Estatísticas por Competição</h4>
      {% if estatisticas_por_competicao %}
        <div class="table-responsive">
          <table class="table table-striped">
            <thead>
              <tr>
                <th>Competição</th>
                <th>Gols</th>
                <th>Assistências</th>
                <th>Amarelos</th>
                <th>Vermelhos</th>
              </tr>
            </thead>
            <tbody>
              {% for estat in estatisticas_por_competicao %}
                <tr>
                  <td>{{ estat.competicao.nome }}</td>
                  <td>{{ estat.gols }}</td>
                  <td>{{ estat.assistencias }}</td>
                  <td>{{ estat.amarelos }}</td>
                  <td>{{ estat.vermelhos }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <p>Você ainda não participou de nenhuma competição.</p>
      {% endif %}
    </div>
  </div>

  <a href="{% url 'pagina_jogador' %}" class="btn btn-secondary">Voltar</a>
</div>
{% endblock %}
